<dialog:CustomDialog
    x:Class="LabelVal.ImageViewer3D.Views.ImageViewer3DDialogView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:LabelVal.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:dialog="clr-namespace:MahApps.Metro.Controls.Dialogs;assembly=MahApps.Metro"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:iv3d="clr-namespace:LabelVal.ImageViewer3D.Views"
    xmlns:local="clr-namespace:LabelVal.ImageViewer3D.Views"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:vm="clr-namespace:LabelVal.ImageViewer3D.ViewModels"
    Width="{Binding Width}"
    Height="{Binding Height}"
    d:DataContext="{d:DesignInstance Type=vm:ImageViewer3D_SingleMesh}"
    d:DesignHeight="800"
    d:DesignWidth="800"
    dialog:DialogParticipation.Register="{Binding}"
    Loaded="CustomDialog_Loaded"
    PreviewKeyDown="CustomDialog_PreviewKeyDown"
    Style="{StaticResource {x:Type dialog:BaseMetroDialog}}"
    mc:Ignorable="d">

    <dialog:CustomDialog.Resources>
        <converters:Double2String x:Key="double2String" />
    </dialog:CustomDialog.Resources>

    <dialog:CustomDialog.DialogTop>

        <Grid HorizontalAlignment="Center" VerticalAlignment="Top">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="1" Grid.Column="0">

                <TextBlock Style="{StaticResource MahApps.Styles.TextBlock.HamburgerMenuHeader}" Text="Near" />

                <ToggleButton
                    Width="48"
                    Height="48"
                    IsChecked="{Binding WhiteFront}">
                    <ToggleButton.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.ToggleButton.Flat}" TargetType="ToggleButton">

                            <Setter Property="Content">
                                <Setter.Value>
                                    <Grid Width="32" Height="32">
                                        <DockPanel HorizontalAlignment="Left" VerticalAlignment="Top">
                                            <iconPacks:PackIconMaterial
                                                Width="22"
                                                Height="22"
                                                BorderThickness="0"
                                                Foreground="Black"
                                                Kind="Square" />
                                        </DockPanel>
                                        <DockPanel HorizontalAlignment="Right" VerticalAlignment="Bottom">
                                            <iconPacks:PackIconMaterial
                                                Width="28"
                                                Height="20"
                                                BorderThickness="0"
                                                Foreground="White"
                                                Kind="Square" />
                                        </DockPanel>
                                    </Grid>
                                </Setter.Value>
                            </Setter>


                            <Setter Property="Background" Value="{DynamicResource MahApps.HamburgerMenu.Pane.Background}" />
                            <Setter Property="Foreground" Value="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding WhiteFront}" Value="False">
                                    <Setter Property="Content">
                                        <Setter.Value>
                                            <Grid Width="32" Height="32">
                                                <DockPanel HorizontalAlignment="Left" VerticalAlignment="Top">
                                                    <iconPacks:PackIconMaterial
                                                        Width="20"
                                                        Height="20"
                                                        BorderThickness="0"
                                                        Foreground="White"
                                                        Kind="Square" />
                                                </DockPanel>
                                                <DockPanel HorizontalAlignment="Right" VerticalAlignment="Bottom">
                                                    <iconPacks:PackIconMaterial
                                                        Width="30"
                                                        Height="22"
                                                        BorderThickness="0"
                                                        Foreground="Black"
                                                        Kind="Square" />
                                                </DockPanel>
                                            </Grid>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style>
                </ToggleButton>

                <Separator />

                <TextBlock Style="{StaticResource MahApps.Styles.TextBlock.HamburgerMenuHeader}" Text="Norm." />

                <ToggleButton
                    Width="48"
                    Height="48"
                    Background="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
                    Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                    IsChecked="{Binding ShowNormals}"
                    ToolTip="Show Normals">
                    <ToggleButton.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.ToggleButton.Flat}" TargetType="ToggleButton">
                            <Setter Property="Content" Value="{iconPacks:Material Kind=TextureBox, Height=28, Width=28}" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ShowNormals}" Value="False">
                                    <Setter Property="Content" Value="{iconPacks:Material Kind=SlashForward, Height=28, Width=28}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style>
                </ToggleButton>

                <Separator />

                <TextBlock Style="{StaticResource MahApps.Styles.TextBlock.HamburgerMenuHeader}" Text="Planes" />

                <ToggleButton
                    Width="48"
                    Height="48"
                    Background="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
                    Foreground="Blue"
                    IsChecked="{Binding EnablePlaneXy}">
                    <ToggleButton.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.ToggleButton.Flat}" TargetType="ToggleButton">
                            <Setter Property="Content" Value="{iconPacks:Material Kind=AxisZArrow, Height=28, Width=28}" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding EnablePlaneXy}" Value="False">
                                    <Setter Property="Content" Value="{iconPacks:Material Kind=AxisZArrowLock, Height=28, Width=28}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style>
                </ToggleButton>

                <ToggleButton
                    Width="48"
                    Height="48"
                    Background="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
                    Foreground="Red"
                    IsChecked="{Binding EnablePlaneYz}">
                    <ToggleButton.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.ToggleButton.Flat}" TargetType="ToggleButton">
                            <Setter Property="Content" Value="{iconPacks:Material Kind=AxisXArrow, Height=28, Width=28}" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding EnablePlaneYz}" Value="False">
                                    <Setter Property="Content" Value="{iconPacks:Material Kind=AxisXArrowLock, Height=28, Width=28}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style>
                </ToggleButton>

                <ToggleButton
                    Width="48"
                    Height="48"
                    Background="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
                    Foreground="Green"
                    IsChecked="{Binding EnablePlaneZx}">
                    <ToggleButton.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.ToggleButton.Flat}" TargetType="ToggleButton">
                            <Setter Property="Content" Value="{iconPacks:Material Kind=AxisYArrow, Height=28, Width=28}" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding EnablePlaneZx}" Value="False">
                                    <Setter Property="Content" Value="{iconPacks:Material Kind=AxisYArrowLock, Height=28, Width=28}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style>

                </ToggleButton>

                <Button
                    Width="48"
                    Height="48"
                    Background="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
                    Command="{Binding ResetCuttingPlanesCommand}"
                    Content="{iconPacks:Material Kind=Refresh,
                                                 Height=28,
                                                 Width=28}"
                    Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                    Style="{StaticResource MahApps.Styles.Button.Flat}" />
            </StackPanel>

            <DockPanel
                Grid.Row="0"
                Grid.Column="1"
                HorizontalAlignment="Right">

                <Button
                    Name="CloseButton"
                    Width="30"
                    Height="30"
                    Margin="3"
                    Click="CloseButton_Click"
                    Style="{StaticResource MahApps.Styles.Button.Hamburger}">
                    <iconPacks:Modern Kind="Close" />
                </Button>

            </DockPanel>

            <md:Card
                x:Name="crdSource"
                Grid.Row="0"
                Grid.Column="1"
                HorizontalAlignment="Center"
                Background="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
                Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}">

                <DockPanel>

                    <DockPanel Margin="3">

                        <TextBox
                            Margin="5,0"
                            md:TextFieldAssist.SuffixText="px"
                            BorderThickness="0"
                            IsHitTestVisible="False"
                            Text="{Binding Image.PixelWidth, Mode=OneWay}" />

                        <TextBox
                            Margin="5,0"
                            md:TextFieldAssist.SuffixText="px"
                            BorderThickness="0"
                            IsHitTestVisible="False"
                            Text="{Binding Image.PixelHeight, Mode=OneWay}" />

                        <DockPanel Margin="6,0">

                            <TextBox
                                Margin="5,0"
                                md:TextFieldAssist.SuffixText="DPI"
                                BorderThickness="0"
                                IsHitTestVisible="False"
                                Text="{Binding Image.DpiX, StringFormat=N, Converter={StaticResource double2String}, Mode=OneWay}" />

                            <TextBox
                                Margin="5,0"
                                md:TextFieldAssist.SuffixText="DPI"
                                BorderThickness="0"
                                IsHitTestVisible="False"
                                Text="{Binding Image.DpiY, StringFormat=N, Converter={StaticResource double2String}, Mode=OneWay}" />

                        </DockPanel>

                        <ToggleButton
                            Width="48"
                            Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                            IsChecked="{Binding ShowWireframe}"
                            Style="{StaticResource MahApps.Styles.ToggleButton}">

                            <md:ToggleButtonAssist.OnContent>
                                <iconPacks:Material Kind="ImageFilterBlackWhite" />
                            </md:ToggleButtonAssist.OnContent>

                            <iconPacks:Material Kind="BlackMesa" />

                        </ToggleButton>



                        <Button
                            Name="Reset"
                            Margin="3"
                            Click="Reset_Click"
                            Content="{iconPacks:Material Kind=ArrowExpandAll}"
                            Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                            Style="{StaticResource MahApps.Styles.Button.Hamburger}" />




                    </DockPanel>

                </DockPanel>
            </md:Card>

            <iv3d:ImageViewer3D
                x:Name="ImageViewer3D"
                Grid.Row="1"
                Grid.Column="1"
                MaxWidth="{Binding Width3DWindow}"
                MaxHeight="{Binding Height3DWindow}"
                DataContext="{Binding}" />

        </Grid>

    </dialog:CustomDialog.DialogTop>


</dialog:CustomDialog>
