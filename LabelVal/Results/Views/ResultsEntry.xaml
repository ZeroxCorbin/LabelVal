<UserControl
    x:Class="LabelVal.Results.Views.ResultsEntry"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Dialog="clr-namespace:MahApps.Metro.Controls.Dialogs;assembly=MahApps.Metro"
    xmlns:bar_common="clr-namespace:BarcodeVerification.lib.Common;assembly=BarcodeVerification.lib"
    xmlns:converters="clr-namespace:LabelVal.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:helpers="clr-namespace:LabelVal.Results.Helpers"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:imageroll="clr-namespace:LabelVal.ImageRolls.ViewModels"
    xmlns:local="clr-namespace:LabelVal.Results.Views"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:vm="clr-namespace:LabelVal.Results.ViewModels"
    Dialog:DialogParticipation.Register="{Binding}"
    d:DataContext="{d:DesignInstance Type=vm:ResultsEntry,
                                     IsDesignTimeCreatable=False}"
    Loaded="UserControl_Loaded"
    Unloaded="UserControl_Unloaded"
    mc:Ignorable="d">

    <UserControl.Resources>

        <DataTemplate x:Key="V5Template">
            <!--  Define your V5 template here  -->
            <local:ResultsDeviceEntry_V5 />
        </DataTemplate>

        <DataTemplate x:Key="V275Template">
            <!--  Define your V275 template here  -->
            <local:ResultsDeviceEntry_V275 />
        </DataTemplate>

        <DataTemplate x:Key="L95Template">
            <!--  Define your L95 template here  -->
            <local:ResultsDeviceEntry_L95 />
        </DataTemplate>

        <helpers:ResultsDeviceEntryTemplateSelector
            x:Key="ResultsDeviceEntryTemplateSelector"
            x:Shared="false"
            L95Template="{StaticResource L95Template}"
            V275Template="{StaticResource V275Template}"
            V5Template="{StaticResource V5Template}" />

        <DataTemplate x:Key="V275Buttons" DataType="{x:Type vm:ResultsDeviceEntryV275}">
            <DockPanel>

                <!--  V275  -->
                <Border
                    Margin="3,0,0,0"
                    BorderBrush="{DynamicResource V275_Brush_Active}"
                    BorderThickness="1"
                    CornerRadius="3">

                    <Border.Style>
                        <Style TargetType="{x:Type Border}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.Offline}">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                    <Setter Property="ToolTip" Value="V275: Process the source image and detect sectors." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                    <Setter Property="ToolTip" Value="V275: Process the source image and restore sectors from the database." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                    <Setter Property="ToolTip" Value="V275: Process the source image without sector detection or restoration." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                    <Setter Property="ToolTip" Value="V275: Trigger the printer, then detect sectors." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                    <Setter Property="ToolTip" Value="V275: Trigger the printer, then restore sectors from the database." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                    <Setter Property="ToolTip" Value="V275: Trigger the printer." />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>

                    <Button
                        Width="48"
                        Height="48"
                        HorizontalContentAlignment="Stretch"
                        VerticalContentAlignment="Stretch"
                        Command="{Binding ProcessCommand}"
                        Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                        Style="{StaticResource MahApps.Styles.Button.Hamburger}">

                        <DockPanel>
                            <TextBlock
                                HorizontalAlignment="Center"
                                DockPanel.Dock="Top"
                                Style="{StaticResource MahApps.Styles.TextBlock.AutoCollapsing}"
                                Text="V275"
                                Visibility="{Binding ResultssManager.AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />

                            <Grid Background="{DynamicResource V275_Brush_Active}">

                                <mah:MetroProgressBar
                                    Width="62"
                                    Height="6"
                                    Padding="0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Foreground="White"
                                    IsIndeterminate="{Binding IsWorking}"
                                    Visibility="{Binding IsWorking, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                <!--  Camera  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>

                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>

                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="Printer" />
                                </Grid>

                                <!--  Simulator  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <Grid>
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.ImageType}" Value="{x:Static imageroll:ImageRollImageTypes.Source}">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>

                                        <iconPacks:PackIconMaterial
                                            Width="18"
                                            Height="18"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Kind="FilmstripBox" />
                                    </Grid>

                                    <Grid>
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.ImageType}" Value="{x:Static imageroll:ImageRollImageTypes.Stored}">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>

                                        <iconPacks:PackIconMaterial
                                            Width="18"
                                            Height="18"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Kind="StoreOutline" />
                                    </Grid>
                                </Grid>

                                <!--  Detect  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="DataMatrixScan" />
                                </Grid>

                                <!--  Restore  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="StoreOutline" />
                                </Grid>

                                <!--  Trigger  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="Minus" />
                                </Grid>
                            </Grid>
                        </DockPanel>
                    </Button>
                </Border>

            </DockPanel>
        </DataTemplate>

        <DataTemplate x:Key="V5Buttons" DataType="{x:Type vm:ResultsDeviceEntry_V5}">
            <DockPanel>

                <Border
                    Margin="3,0,0,0"
                    BorderBrush="{DynamicResource V5_Brush_Active}"
                    BorderThickness="1"
                    CornerRadius="3">

                    <Border.Style>
                        <Style TargetType="{x:Type Border}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.Offline}">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                    <Setter Property="ToolTip" Value="V5: Process the source image and detect sectors." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                    <Setter Property="ToolTip" Value="V5: Process the source image and restore sectors from the database." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                    <Setter Property="ToolTip" Value="V5: Process the source image without sector detection or restoration." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                    <Setter Property="ToolTip" Value="V5: Trigger the camera, then detect sectors." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                    <Setter Property="ToolTip" Value="V5: Trigger the camera, then restore sectors from the database." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                    <Setter Property="ToolTip" Value="V5: Trigger the camera." />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>

                    <Button
                        Width="48"
                        Height="48"
                        HorizontalContentAlignment="Stretch"
                        VerticalContentAlignment="Stretch"
                        Command="{Binding ProcessCommand}"
                        CommandParameter="{x:Static vm:ResultsEntryDevices.V5}"
                        Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                        Style="{StaticResource MahApps.Styles.Button.Hamburger}">

                        <DockPanel>
                            <TextBlock
                                HorizontalAlignment="Center"
                                DockPanel.Dock="Top"
                                Style="{StaticResource MahApps.Styles.TextBlock.AutoCollapsing}"
                                Text="V5"
                                Visibility="{Binding ResultssManager.AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />

                            <Grid Background="{DynamicResource V5_Brush_Active}">

                                <mah:MetroProgressBar
                                    Width="62"
                                    Height="6"
                                    Padding="0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Foreground="White"
                                    IsIndeterminate="{Binding IsWorking}"
                                    Visibility="{Binding IsWorking, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                <!--  Camera  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>

                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>

                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="CameraIris" />
                                </Grid>

                                <!--  Simulator  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <Grid>
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.ImageType}" Value="{x:Static imageroll:ImageRollImageTypes.Source}">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>

                                        <iconPacks:PackIconMaterial
                                            Width="18"
                                            Height="18"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Kind="FilmstripBox" />
                                    </Grid>

                                    <Grid>
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.ImageType}" Value="{x:Static imageroll:ImageRollImageTypes.Stored}">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>

                                        <iconPacks:PackIconMaterial
                                            Width="18"
                                            Height="18"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Kind="StoreOutline" />
                                    </Grid>
                                </Grid>

                                <!--  Detect  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="DataMatrixScan" />
                                </Grid>

                                <!--  Restore  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="StoreOutline" />
                                </Grid>

                                <!--  Trigger  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="Minus" />
                                </Grid>
                            </Grid>
                        </DockPanel>
                    </Button>
                </Border>

            </DockPanel>
        </DataTemplate>

        <DataTemplate x:Key="L95Buttons" DataType="{x:Type vm:ResultsDeviceEntry_L95}">
            <DockPanel>

                <!--  L95 Process Image  -->
                <Border
                    Margin="3,0,0,0"
                    BorderBrush="{DynamicResource L95_Brush_Active}"
                    BorderThickness="1"
                    CornerRadius="3">

                    <Border.Style>
                        <Style TargetType="{x:Type Border}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.Offline}">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                    <Setter Property="ToolTip" Value="L95: Process the source image and detect sectors." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                    <Setter Property="ToolTip" Value="L95: Process the source image and restore sectors from the database." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                    <Setter Property="ToolTip" Value="L95: Process the source image without sector detection or restoration." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                    <Setter Property="ToolTip" Value="L95: Trigger the camera, then detect sectors." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                    <Setter Property="ToolTip" Value="L95: Trigger the camera, then restore sectors from the database." />
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                    <Setter Property="ToolTip" Value="L95: Trigger the camera." />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>

                    <Button
                        Width="48"
                        Height="48"
                        HorizontalContentAlignment="Stretch"
                        VerticalContentAlignment="Stretch"
                        Command="{Binding ProcessCommand}"
                        Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                        IsEnabled="{Binding ResultssManager.IsL95Working, Converter={StaticResource InvertBool}}"
                        Style="{StaticResource MahApps.Styles.Button.Hamburger}">

                        <DockPanel>
                            <TextBlock
                                HorizontalAlignment="Center"
                                DockPanel.Dock="Top"
                                Style="{StaticResource MahApps.Styles.TextBlock.AutoCollapsing}"
                                Text="L95"
                                Visibility="{Binding ResultssManager.AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />

                            <Grid Background="{DynamicResource L95_Brush_Active}">

                                <mah:MetroProgressBar
                                    Width="62"
                                    Height="6"
                                    Padding="0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Foreground="White"
                                    IsIndeterminate="{Binding IsWorking}"
                                    Visibility="{Binding IsWorking, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                <!--  Camera  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>

                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>

                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="CameraIris" />
                                </Grid>

                                <!--  Simulator  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <Grid>
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.ImageType}" Value="{x:Static imageroll:ImageRollImageTypes.Source}">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>

                                        <iconPacks:PackIconMaterial
                                            Width="18"
                                            Height="18"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Kind="FilmstripBox" />
                                    </Grid>

                                    <Grid>
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.ImageType}" Value="{x:Static imageroll:ImageRollImageTypes.Stored}">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>

                                        <iconPacks:PackIconMaterial
                                            Width="18"
                                            Height="18"
                                            Margin="3,0"
                                            VerticalAlignment="Center"
                                            Kind="StoreOutline" />
                                    </Grid>
                                </Grid>

                                <!--  Detect  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraDetect}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="DataMatrixScan" />
                                </Grid>

                                <!--  Restore  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraRestore}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="StoreOutline" />
                                </Grid>

                                <!--  Trigger  -->
                                <Grid
                                    Margin="0,6"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom">
                                    <Grid.Style>
                                        <Style TargetType="{x:Type Grid}">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.SimulatorTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.CameraTrigger}">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Style>

                                    <iconPacks:PackIconMaterial
                                        Width="18"
                                        Height="18"
                                        Margin="3,0"
                                        VerticalAlignment="Center"
                                        Kind="Minus" />
                                </Grid>
                            </Grid>
                        </DockPanel>
                    </Button>
                </Border>

                <!--  Redirect  -->
                <ToggleButton
                    Width="48"
                    Height="48"
                    Margin="3,0,0,0"
                    Padding="0"
                    HorizontalContentAlignment="Stretch"
                    VerticalContentAlignment="Stretch"
                    BorderBrush="{DynamicResource L95_Brush_Active}"
                    Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                    IsChecked="{Binding IsSelected}"
                    IsEnabled="{Binding ResultssManager.IsL95Working, Converter={StaticResource InvertBool}}">
                    <ToggleButton.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.ToggleButton}" TargetType="ToggleButton">
                            <Setter Property="ToolTip" Value="Redirect L95 results to this image roll." />
                            <Setter Property="Content">
                                <Setter.Value>
                                    <DockPanel>
                                        <DockPanel>
                                            <TextBlock
                                                HorizontalAlignment="Center"
                                                DockPanel.Dock="Top"
                                                Style="{StaticResource MahApps.Styles.TextBlock.AutoCollapsing}"
                                                Text="L95"
                                                Visibility="{Binding ResultssManager.AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                            <Grid>
                                                <Image
                                                    Width="24"
                                                    Height="24"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Source="/Assets/Images/l95-white-outline.ico" />
                                            </Grid>
                                        </DockPanel>
                                    </DockPanel>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>

                                <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                    <Setter Property="ToolTip" Value="L95 results are being redirected to this image roll. Click to disable." />
                                    <Setter Property="Content">
                                        <Setter.Value>
                                            <DockPanel>
                                                <TextBlock
                                                    HorizontalAlignment="Center"
                                                    DockPanel.Dock="Top"
                                                    Style="{StaticResource MahApps.Styles.TextBlock.AutoCollapsing}"
                                                    Text="L95"
                                                    Visibility="{Binding ResultssManager.AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                                <Grid Background="{DynamicResource L95_Brush_Active}">
                                                    <Grid
                                                        Margin="3,6"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Bottom">

                                                        <iconPacks:PackIconMaterial
                                                            Width="18"
                                                            Height="18"
                                                            Margin="3,0"
                                                            VerticalAlignment="Center"
                                                            Kind="Headphones" />
                                                    </Grid>

                                                    <iconPacks:PackIconMaterial
                                                        Width="18"
                                                        Height="18"
                                                        Margin="0,6"
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Bottom"
                                                        Kind="ChevronTripleDown" />
                                                </Grid>
                                            </DockPanel>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Handler}" Value="{x:Static bar_common:LabelHandlers.Offline}">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>

                        </Style>
                    </ToggleButton.Style>
                </ToggleButton>

            </DockPanel>
        </DataTemplate>

        <helpers:ResultsDeviceEntryTemplateSelector
            x:Key="DeviceButtonsTemplateSelector"
            x:Shared="false"
            L95Template="{StaticResource L95Buttons}"
            V275Template="{StaticResource V275Buttons}"
            V5Template="{StaticResource V5Buttons}" />

    </UserControl.Resources>

    <DockPanel HorizontalAlignment="Left">

        <!--  Top Bar  -->
        <md:Card
            Margin="3"
            HorizontalAlignment="Left"
            Background="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
            DockPanel.Dock="Top"
            Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}">

            <DockPanel>

                <DockPanel Width="48" Height="48">

                    <DockPanel
                        Width="36"
                        Margin="0,4,0,2"
                        VerticalAlignment="Top"
                        DockPanel.Dock="Top">
                        <iconPacks:PackIconMaterial
                            Width="30"
                            Height="18"
                            HorizontalAlignment="Center"
                            Kind="ImageText" />
                    </DockPanel>

                    <TextBlock
                        Margin="11,0,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        FontSize="{DynamicResource MahApps.Font.Size.Dialog.Message}"
                        FontWeight="Bold"
                        Text="{Binding SourceImage.Order}" />
                </DockPanel>

                <Border Style="{StaticResource imageBar}" />

                <!--  Only Print Source Image  -->
                <Button
                    Width="48"
                    d:Visibility="Visible"
                    Command="{Binding ProcessCommand}"
                    CommandParameter="{x:Static vm:ResultsEntryDevices.V275}"
                    Style="{StaticResource MahApps.Styles.Button.Hamburger}"
                    ToolTip="Print the source image using the V275 printer.">

                    <Grid>
                        <!--<mah:ProgressRing
                            Width="28"
                            Height="28"
                            Foreground="White"
                            IsActive="{Binding IsV275Working}" />-->

                        <iconPacks:PackIconMaterial
                            Width="24"
                            Height="24"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                            Kind="Printer" />
                    </Grid>
                </Button>

                <ItemsControl ItemTemplateSelector="{StaticResource DeviceButtonsTemplateSelector}" ItemsSource="{Binding ResultsDeviceEntries}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <DockPanel />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>

            </DockPanel>
        </md:Card>

        <!--  Left Bar  -->
        <md:Card
            Width="48"
            Margin="3,0,0,0"
            HorizontalAlignment="Left"
            Background="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
            DockPanel.Dock="Left"
            Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}">

            <DockPanel>

                <Button
                    x:Name="btnMove"
                    Height="48"
                    d:Visibility="Visible"
                    Click="btnMove_Click"
                    Content="{iconPacks:Material Kind=ArrowUpDownBold,
                                                 Width=24,
                                                 Height=24}"
                    DockPanel.Dock="Top"
                    Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                    ToolTip="Move image within the roll.">
                    <Button.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.Button.Hamburger}" TargetType="Button">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.IsLocked}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Popup x:Name="popMove" Width="{Binding ActualWidth, ElementName=btnMove}">

                    <md:Card
                        Padding="3"
                        Background="{DynamicResource MahApps.Brushes.ThemeBackground}"
                        BorderBrush="{DynamicResource MahApps.Brushes.Accent2}"
                        BorderThickness="2"
                        Style="{StaticResource MaterialDesignElevatedCard}">
                        <StackPanel>

                            <Button
                                Margin="0,3"
                                VerticalAlignment="Top"
                                d:Visibility="Visible"
                                BorderThickness="0"
                                Click="btnMoveImage_Click"
                                Content="{iconPacks:Material Kind=ArrowCollapseUp}"
                                Tag="top"
                                ToolTip="Move to Top">

                                <Button.Style>
                                    <Style BasedOn="{StaticResource MahApps.Styles.Button}" TargetType="Button">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SourceImage.Order}" Value="1">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.IsLocked}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <Button
                                Margin="0,3"
                                VerticalAlignment="Top"
                                d:Visibility="Visible"
                                BorderThickness="0"
                                Click="btnMoveImage_Click"
                                Content="{iconPacks:Material Kind=ArrowUp}"
                                Tag="up"
                                ToolTip="Move Up">

                                <Button.Style>
                                    <Style BasedOn="{StaticResource MahApps.Styles.Button}" TargetType="Button">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SourceImage.Order}" Value="1">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.IsLocked}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <Separator />

                            <Button
                                Margin="0,3"
                                VerticalAlignment="Top"
                                d:Visibility="Visible"
                                BorderThickness="0"
                                Click="btnMoveImage_Click"
                                Content="{iconPacks:Material Kind=ArrowDown}"
                                Tag="down"
                                ToolTip="Move Down">
                                <Button.Style>
                                    <Style BasedOn="{StaticResource MahApps.Styles.Button}" TargetType="Button">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.IsLocked}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <Button
                                Margin="0,3"
                                VerticalAlignment="Top"
                                d:Visibility="Visible"
                                BorderThickness="0"
                                Click="btnMoveImage_Click"
                                Content="{iconPacks:Material Kind=ArrowCollapseDown}"
                                Tag="bottom"
                                ToolTip="Move to Bottom">

                                <Button.Style>
                                    <Style BasedOn="{StaticResource MahApps.Styles.Button}" TargetType="Button">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.IsLocked}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                        </StackPanel>
                    </md:Card>
                </Popup>

                <Button
                    Height="48"
                    d:Visibility="Visible"
                    Click="btnShowDetailsToggle"
                    DockPanel.Dock="Top"
                    Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}">

                    <iconPacks:PackIconMaterial Kind="InformationVariant" />

                    <Button.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.Button.Hamburger}" TargetType="{x:Type Button}">
                            <Setter Property="ToolTip" Value="Show image details." />

                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ShowDetails}" Value="True">
                                    <Setter Property="ToolTip" Value="Hide image details." />
                                </DataTrigger>

                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button
                    Height="48"
                    VerticalAlignment="Bottom"
                    d:Visibility="Visible"
                    Command="{Binding ResultssManager.DeleteImageCommand}"
                    CommandParameter="{Binding}"
                    Content="{iconPacks:Material Kind=Delete,
                                                 Width=24,
                                                 Height=24}"
                    DockPanel.Dock="Top"
                    Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                    ToolTip="Delete this image from the roll.">
                    <Button.Style>
                        <Style BasedOn="{StaticResource MahApps.Styles.Button.Hamburger}" TargetType="{x:Type Button}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ResultssManager.SelectedImageRoll.IsLocked}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

            </DockPanel>

        </md:Card>


        <DockPanel>

            <local:ResultsEntry_Images Margin="3,0,0,0" DataContext="{Binding}" />

            <ItemsControl ItemTemplateSelector="{StaticResource ResultsDeviceEntryTemplateSelector}" ItemsSource="{Binding ResultsDeviceEntries}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <DockPanel />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
            </ItemsControl>
        </DockPanel>

    </DockPanel>
</UserControl>