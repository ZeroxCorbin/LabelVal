<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Templates/SharedButtonStyles.xaml" />
        <ResourceDictionary Source="/Results/Views/V5Templates/V5TriggerButton.xaml" />
        <ResourceDictionary Source="/Results/Views/V275Templates/V275TriggerButton.xaml" />
        <ResourceDictionary Source="/Results/Views/L95Templates/L95Buttons.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <ControlTemplate x:Key="ToolBarTemplate">
        <ToolBarTray>
            <ToolBar
                Margin="0"
                BorderThickness="0"
                ToolBarTray.IsLocked="True">


                <!--  Button to add new images to the roll. Visible only when the roll is not locked.  -->
                <Button Command="{Binding AddImageCommand}" ToolTip="Add new image(s) to the roll.">
                    <Button.Style>
                        <Style BasedOn="{StaticResource ToolBarButton}" TargetType="{x:Type Button}">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ActiveImageRoll.IsLocked}" Value="False">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>

                    <DockPanel>
                        <TextBlock
                            HorizontalAlignment="Center"
                            DockPanel.Dock="Top"
                            Text="Add Image"
                            Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />

                        <iconPacks:PackIconMaterial
                            Width="24"
                            Height="24"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Kind="ImagePlus" />

                    </DockPanel>

                </Button>

                <Separator Margin="6,0,3,0" Visibility="{Binding ActiveImageRoll.IsLocked, Converter={StaticResource BoolToVisibility}, ConverterParameter=Invert}" />

                <!--  Device-specific buttons are loaded here from resources.  -->
                <ContentControl Content="{StaticResource V275TriggerButton}" />
                <ContentControl Content="{StaticResource V5TriggerButton}" />
                <StackPanel Orientation="Horizontal">
                    <ContentControl Content="{StaticResource L95TriggerButton}" />
                    <ContentControl Content="{StaticResource L95RedirectButton}" />
                </StackPanel>

                <Separator Margin="6,0,3,0" Visibility="{Binding ActiveImageRoll.IsLocked, Converter={StaticResource BoolToVisibility}, ConverterParameter=Invert}" />

                <!--  Image Size Slider  -->
                <DockPanel Margin="3,1,3,0" VerticalAlignment="Stretch">

                    <TextBlock
                        Margin="0,0,0,2"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Top"
                        DockPanel.Dock="Top">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ImagesMaxHeight}" Value="400">
                                        <Setter Property="Text" Value="Ex. Large" />
                                    </DataTrigger>

                                    <DataTrigger Binding="{Binding ImagesMaxHeight}" Value="300">
                                        <Setter Property="Text" Value="Large" />
                                    </DataTrigger>

                                    <DataTrigger Binding="{Binding ImagesMaxHeight}" Value="200">
                                        <Setter Property="Text" Value="Regular" />
                                    </DataTrigger>

                                    <DataTrigger Binding="{Binding ImagesMaxHeight}" Value="100">
                                        <Setter Property="Text" Value="Small" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <Slider
                        Width="48"
                        Height="24"
                        mah:SliderHelper.ChangeValueBy="LargeChange"
                        IsSnapToTickEnabled="True"
                        Maximum="400"
                        Minimum="100"
                        Style="{StaticResource MahApps.Styles.Slider.Flat}"
                        TickFrequency="100"
                        TickPlacement="BottomRight"
                        ToolTip="Adjust the size of the images in the list."
                        Value="{Binding ImagesMaxHeight}" />

                </DockPanel>

                <!--  Toggle button to show or hide alarms for errors and warnings.  -->
                <StackPanel Margin="3,0" VerticalAlignment="Center">
                    <TextBlock
                        Margin="0,0,0,2"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Top"
                        FontSize="10"
                        FontWeight="DemiBold"
                        Text="Alarms"
                        Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />
                    <ToggleButton IsChecked="{Binding HideErrorsWarnings}">
                        <ToggleButton.Style>
                            <Style BasedOn="{StaticResource ToolBarActionToggleButton}" TargetType="ToggleButton">
                                <Setter Property="ToolTip" Value="Show alarms for errors and warnings." />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding HideErrorsWarnings}" Value="True">
                                        <Setter Property="ToolTip" Value="Hide alarms for errors and warnings." />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ToggleButton.Style>

                        <md:ToggleButtonAssist.OnContent>

                            <iconPacks:PackIconFontAwesome
                                Width="22"
                                Height="22"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Kind="BellSlashSolid" />

                        </md:ToggleButtonAssist.OnContent>

                        <iconPacks:PackIconFontAwesome
                            Width="22"
                            Height="22"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Kind="BellSolid" />

                    </ToggleButton>
                </StackPanel>

                <!--  Toggle button to switch between automatic and fixed dual-column layout for sectors.  -->
                <StackPanel Margin="3,0" VerticalAlignment="Center">
                    <TextBlock
                        Margin="0,0,0,2"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Top"
                        FontSize="10"
                        FontWeight="DemiBold"
                        Text="Columns"
                        Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />

                    <ToggleButton IsChecked="{Binding DualSectorColumns}">
                        <ToggleButton.Style>
                            <Style BasedOn="{StaticResource ToolBarActionToggleButton}" TargetType="ToggleButton">
                                <Setter Property="ToolTip" Value="Automatically adjust sector columns based on image size." />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding DualSectorColumns}" Value="True">
                                        <Setter Property="ToolTip" Value="Use a fixed dual-column layout for sectors." />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ToggleButton.Style>

                        <md:ToggleButtonAssist.OnContent>
                            <Grid>
                                <iconPacks:PackIconModern
                                    Width="22"
                                    Height="22"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Kind="ColumnTwo" />
                            </Grid>
                        </md:ToggleButtonAssist.OnContent>

                        <Grid>
                            <iconPacks:PackIconModern
                                Width="22"
                                Height="22"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Kind="ColumnTwo" />
                            <iconPacks:PackIconMaterial
                                Width="18"
                                Height="18"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Background}"
                                Kind="AlphaA" />
                        </Grid>
                    </ToggleButton>
                </StackPanel>

                <!--  Toggle button to show or hide extended data for 2D grid sectors.  -->
                <StackPanel Margin="3,0" VerticalAlignment="Center">
                    <TextBlock
                        Margin="0,0,0,2"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Top"
                        FontSize="10"
                        FontWeight="DemiBold"
                        Text="2D Grids"
                        Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />

                    <ToggleButton IsChecked="{Binding ShowExtendedData}">
                        <ToggleButton.Style>
                            <Style BasedOn="{StaticResource ToolBarActionToggleButton}" TargetType="ToggleButton">
                                <Setter Property="ToolTip" Value="Show extended data for 2D grid sectors." />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ShowExtendedData}" Value="True">
                                        <Setter Property="ToolTip" Value="Hide extended data for 2D grid sectors." />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ToggleButton.Style>

                        <md:ToggleButtonAssist.OnContent>
                            <Grid>
                                <iconPacks:PackIconModern
                                    Width="22"
                                    Height="22"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Kind="Grid" />
                                <iconPacks:PackIconJamIcons
                                    Width="22"
                                    Height="22"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Kind="QrCode" />
                            </Grid>
                        </md:ToggleButtonAssist.OnContent>
                        <Grid>
                            <iconPacks:PackIconJamIcons
                                Width="22"
                                Height="22"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Kind="QrCode" />
                        </Grid>
                    </ToggleButton>
                </StackPanel>

                <Separator Margin="6,0,3,0" />

                <!--  Copy Stored Results -->
                <Button
                    Command="{Binding CopyAllSectorsToClipboardCommand}"
                    CommandParameter="source"
                    ToolTip="Copy all stored sector details to the clipboard as CSV/JSON.">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource ToolBarButton}">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <!-- Show ONLY when stored exists and no current exists -->
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding HasStoredResults}" Value="True"/>
                                        <Condition Binding="{Binding HasCurrentResults}" Value="False"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible"/>
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <DockPanel>
                        <TextBlock
                            HorizontalAlignment="Center"
                            DockPanel.Dock="Top"
                            Text="Stored"
                            Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />
                        <iconPacks:PackIconModern Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Kind="PageCopy" />
                    </DockPanel>
                </Button>

                <!--  Copy Current Results -->
                <Button
                    Command="{Binding CopyAllSectorsToClipboardCommand}"
                    CommandParameter="current"
                    ToolTip="Copy all current sector details to the clipboard as CSV/JSON.">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource ToolBarButton}">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <!-- Show ONLY when current exists and no stored exists -->
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding HasCurrentResults}" Value="True"/>
                                        <Condition Binding="{Binding HasStoredResults}" Value="False"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible"/>
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <DockPanel>
                        <TextBlock
                            HorizontalAlignment="Center"
                            DockPanel.Dock="Top"
                            Text="Current"
                            Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />
                        <iconPacks:PackIconModern Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Kind="PageCopy" />
                    </DockPanel>
                </Button>

                <!--  Copy All (Stored + Current) -->
                <Button
                    Command="{Binding CopyAllSectorsToClipboardCommand}"
                    CommandParameter="all"
                    ToolTip="Copy all stored and current sector details to the clipboard as CSV/JSON.">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource ToolBarButton}">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <!-- Show ONLY when both stored and current exist -->
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding HasStoredResults}" Value="True"/>
                                        <Condition Binding="{Binding HasCurrentResults}" Value="True"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible"/>
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <DockPanel>
                        <TextBlock
                            HorizontalAlignment="Center"
                            DockPanel.Dock="Top"
                            Text="All"
                            Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />
                        <iconPacks:PackIconModern Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Kind="PageCopy" />
                    </DockPanel>
                </Button>

                <Separator Margin="6,0,3,0" />

                <!--  Store All Current Results -->
                <Button
                    Command="{Binding StoreAllCurrentResultsCommand}"
                    ToolTip="Store all current results (images and sectors) to the database.">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource ToolBarButton}">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding HasCurrentResults}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                <!-- Still hide if SelectedResultsDatabase is locked -->
                                <DataTrigger Binding="{Binding SelectedResultsDatabase.IsLocked}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <DockPanel>
                        <TextBlock
                            HorizontalAlignment="Center"
                            DockPanel.Dock="Top"
                            Text="Store All"
                            Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />
                        <iconPacks:PackIconMaterial Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Kind="StorePlusOutline" />
                    </DockPanel>
                </Button>

                <!--  Clear All Current Results -->
                <Button
                    Command="{Binding ClearAllCurrentResultsCommand}"
                    ToolTip="Clear all current results (images and sectors).">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource ToolBarButton}">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding HasCurrentResults}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                    <DockPanel>
                        <TextBlock
                            HorizontalAlignment="Center"
                            DockPanel.Dock="Top"
                            Text="Clear All"
                            Visibility="{Binding AppSettings.ShowButtonText, Converter={StaticResource BooleanToVisibilityConverter}}" />
                        <iconPacks:PackIconMaterialDesign Width="24" Height="24" HorizontalAlignment="Center" VerticalAlignment="Center" Kind="ClearAll" />
                    </DockPanel>
                </Button>
            </ToolBar>
        </ToolBarTray>
    </ControlTemplate>
</ResourceDictionary>
