<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:local="clr-namespace:LabelVal.Main.Views"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:runVm="clr-namespace:LabelVal.Run.ViewModels">

    <!--  Run  -->
    <DataTemplate x:Key="RunMenuItem" DataType="{x:Type runVm:RunManager}">
        <!--  DataContext must be set to Content here.  -->
        <DockPanel DataContext="{Binding Content}">
            <Border Style="{StaticResource hamMenuBottomBar}" />

            <DockPanel Width="48" Height="48">
                <iconPacks:PackIconMaterial
                    Width="36"
                    Height="36"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Kind="Run" />
            </DockPanel>

            <Border Style="{StaticResource imageBar}" />

            <DockPanel
                Margin="10,0"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Center">

                <mah:NumericUpDown
                    Width="78"
                    Height="30"
                    HorizontalAlignment="Center"
                    Interval="1"
                    Maximum="999"
                    Minimum="1"
                    Value="{Binding LoopCount}" />

                <Grid HorizontalAlignment="Left">

                    <mah:ProgressRing
                        Width="36"
                        Height="36"
                        Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}">
                        <mah:ProgressRing.Style>
                            <Style TargetType="{x:Type mah:ProgressRing}">
                                <Setter Property="IsActive" Value="False" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding QuickRunController.RunController.State}" Value="Running">
                                        <Setter Property="IsActive" Value="True" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </mah:ProgressRing.Style>
                    </mah:ProgressRing>

                    <Button
                        Width="36"
                        Height="36"
                        Command="{Binding StartStopCommand}">
                        <Button.Style>
                            <Style BasedOn="{StaticResource MahApps.Styles.Button.Hamburger}" TargetType="{x:Type Button}">
                                <Setter Property="IsEnabled" Value="False" />
                                <Setter Property="Content" Value="{iconPacks:Material Kind=Play, Width=24, Height=24}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedV275Node.Controller.IsLoggedIn_Control}" Value="True">
                                        <Setter Property="IsEnabled" Value="True" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding SelectedV5.Controller.IsConnected}" Value="True">
                                        <Setter Property="IsEnabled" Value="True" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding SelectedL95.Controller.IsConnected}" Value="True">
                                        <Setter Property="IsEnabled" Value="True" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding QuickRunController.RunController.State}" Value="Running">
                                        <Setter Property="Content" Value="{iconPacks:Material Kind=Stop, Width=24, Height=24}" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding QuickRunController.RunController.State}" Value="Error">
                                        <Setter Property="Content" Value="{iconPacks:Material Kind=Eraser, Width=24, Height=24}" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>

                <Button
                    Width="36"
                    Height="36"
                    HorizontalAlignment="Left"
                    Command="{Binding OpenRunWindowCommand, RelativeSource={RelativeSource AncestorType=local:MainWindow}}"
                    Content="{iconPacks:PicolIcons Kind=ServerRun,
                                                   Width=24,
                                                   Height=24}"
                    Foreground="{DynamicResource MahApps.HamburgerMenu.Pane.Foreground}"
                    Style="{StaticResource MahApps.Styles.Button.Hamburger}" />
            </DockPanel>

        </DockPanel>
    </DataTemplate>

</ResourceDictionary>