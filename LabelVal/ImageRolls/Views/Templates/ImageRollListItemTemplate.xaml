<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:barCommon="clr-namespace:BarcodeVerification.lib.Common;assembly=BarcodeVerification.lib"
    xmlns:converters="clr-namespace:LabelVal.Converters"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:imageRollEnums="clr-namespace:LabelVal.ImageRolls.ViewModels"
    xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:viewModels="clr-namespace:LabelVal.ImageRolls.ViewModels">

    <!--  Converter to generate content for tab items.  -->
    <converters:ContentGeneratorConverter x:Key="ContentGeneratorConverter" />

    <!--  DataTemplate for individual items in the Image Roll ListViews.  -->
    <DataTemplate x:Key="ImageRollListItemTemplate" DataType="viewModels:ImageRoll">

        <md:Card
            Margin="3"
            Background="{DynamicResource MahApps.Brushes.Control.Background}"
            Foreground="{DynamicResource MahApps.Brushes.ThemeForeground}">
            <md:Card.Effect>
                <DropShadowEffect
                    BlurRadius="0"
                    Opacity="0.5"
                    ShadowDepth="2"
                    Color="{DynamicResource MahApps.Colors.Accent4}" />
            </md:Card.Effect>

            <DockPanel
                MaxWidth="260"
                Margin="3"
                Background="{DynamicResource MahApps.Brushes.ThemeBackground}">

                <!--  Decorative borders for group styling.  -->
                <Border Style="{StaticResource groupLeft}" />
                <Border Style="{StaticResource groupBottom}" />

                <Grid Margin="6,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Icon representing an image roll.  -->
                    <iconPacks:PackIconMaterial
                        Margin="0,3,6,0"
                        VerticalAlignment="Center"
                        Kind="ImageMultiple" />

                    <!--  Displays the number of images in the roll, hidden if zero.  -->
                    <TextBlock
                        Grid.Row="1"
                        Style="{StaticResource MahApps.Styles.TextBlock.HamburgerMenuHeader}"
                        Text="{Binding ImageCount}" />

                    <Grid
                        Grid.Column="1"
                        Margin="3,0"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Top">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="auto" />
                        </Grid.ColumnDefinitions>

                        <!--
                            This section implements a text trimming effect for long image roll names.
                            When the name overflows, a "..." hint appears. The text can be aligned left or right.
                        -->

                        <!--  Overflow indicator for right-aligned text.  -->
                        <md:SmartHint
                            Grid.Column="0"
                            Margin="3,0"
                            FontSize="14"
                            Hint="...">
                            <md:SmartHint.Style>
                                <Style TargetType="md:SmartHint">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding RightAlignOverflow}" Value="True" />
                                                <Condition Binding="{Binding ComputedHorizontalScrollBarVisibility, ElementName=srcName4}" Value="Visible" />
                                            </MultiDataTrigger.Conditions>
                                            <MultiDataTrigger.Setters>
                                                <Setter Property="Visibility" Value="Visible" />
                                            </MultiDataTrigger.Setters>
                                        </MultiDataTrigger>

                                    </Style.Triggers>
                                </Style>
                            </md:SmartHint.Style>
                        </md:SmartHint>

                        <!--  ScrollViewer to handle long names. FlowDirection is toggled for alignment.  -->
                        <ScrollViewer
                            x:Name="srcName4"
                            Grid.Column="1"
                            Padding="3,0"
                            VerticalAlignment="Center"
                            md:ScrollViewerAssist.BubbleVerticalScroll="True"
                            md:ScrollViewerAssist.IsAutoHideEnabled="True"
                            Focusable="False"
                            HorizontalScrollBarVisibility="Auto"
                            VerticalScrollBarVisibility="Disabled">
                            <ScrollViewer.Resources>
                                <Style TargetType="ScrollBar" />
                                <sys:Double x:Key="{x:Static SystemParameters.HorizontalScrollBarHeightKey}">8</sys:Double>
                            </ScrollViewer.Resources>

                            <ScrollViewer.Style>
                                <Style BasedOn="{StaticResource MaterialDesignScrollViewer}" TargetType="ScrollViewer">
                                    <Setter Property="FlowDirection" Value="LeftToRight" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ImageRollsManager.RightAlignOverflow}" Value="True">
                                            <Setter Property="FlowDirection" Value="RightToLeft" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ScrollViewer.Style>

                            <!--  Displays the name of the image roll.  -->
                            <TextBlock Text="{Binding Name}">
                                <TextBlock.Style>
                                    <Style BasedOn="{StaticResource MaterialDesignBodyMediumTextBlock}" TargetType="TextBlock">
                                        <Setter Property="FlowDirection" Value="LeftToRight" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ImageRollsManager.RightAlignOverflow}" Value="True">
                                                <Setter Property="FlowDirection" Value="RightToLeft" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </ScrollViewer>

                        <!--  Overflow indicator for left-aligned text.  -->
                        <md:SmartHint
                            Grid.Column="2"
                            Margin="3,0"
                            FontSize="14"
                            Hint="...">
                            <md:SmartHint.Style>
                                <Style TargetType="md:SmartHint">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding ImageRollsManager.RightAlignOverflow}" Value="False" />
                                                <Condition Binding="{Binding ComputedHorizontalScrollBarVisibility, ElementName=srcName4}" Value="Visible" />
                                            </MultiDataTrigger.Conditions>
                                            <MultiDataTrigger.Setters>
                                                <Setter Property="Visibility" Value="Visible" />
                                            </MultiDataTrigger.Setters>
                                        </MultiDataTrigger>

                                    </Style.Triggers>
                                </Style>
                            </md:SmartHint.Style>
                        </md:SmartHint>

                        <!--  Displays the GS1 Table number if applicable.  -->
                        <TextBlock
                            Grid.Column="3"
                            Margin="6,3"
                            Text="{Binding SelectedGS1Table, Converter={StaticResource EnumValueToDescription}, StringFormat={}Table {0}}">
                            <TextBlock.Style>
                                <Style BasedOn="{StaticResource MaterialDesignBodyMediumTextBlock}" TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SelectedApplicationStandard}" Value="{x:Static barCommon:ApplicationStandards.GS1}">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Grid>

                    <!--  Panel for status icons at the bottom of the item.  -->
                    <DockPanel
                        Grid.Row="1"
                        Grid.Column="1"
                        HorizontalAlignment="Left">

                        <!--  Displays the target DPI for the image roll.  -->
                        <TextBlock Margin="6,0" VerticalAlignment="Center">
                            <TextBlock.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Offset="0" Color="{DynamicResource MahApps.Colors.Accent2}" />
                                    <GradientStop Offset="1" Color="{DynamicResource MahApps.Colors.Accent4}" />
                                </LinearGradientBrush>
                            </TextBlock.Background>

                            <TextBlock.Style>
                                <Style BasedOn="{StaticResource MahApps.Styles.TextBlock}" TargetType="TextBlock">
                                    <Setter Property="Text" Value="{Binding TargetDPI, StringFormat={}{0} DPI}" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding TargetDPI}" Value="0">
                                            <Setter Property="Text" Value="Any DPI" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>

                        <!--  Icon indicating the sector type (shared or independent).  -->
                        <iconPacks:PackIconMaterial
                            Margin="3"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center">
                            <iconPacks:PackIconMaterial.Style>
                                <Style TargetType="{x:Type iconPacks:PackIconMaterial}">
                                    <Setter Property="Kind" Value="FormatListNumbered" />
                                    <Setter Property="ToolTip" Value="The template sectors are shared." />

                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SectorType}" Value="{x:Static imageRollEnums:ImageRollSectorTypes.Dynamic}">
                                            <Setter Property="Kind" Value="PlaylistEdit" />
                                            <Setter Property="ToolTip" Value="The template sectors are independant." />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </iconPacks:PackIconMaterial.Style>
                        </iconPacks:PackIconMaterial>

                        <!--  Icon indicating if the image roll is locked or unlocked.  -->
                        <iconPacks:PackIconMaterial
                            Margin="3"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center">
                            <iconPacks:PackIconMaterial.Style>
                                <Style TargetType="{x:Type iconPacks:PackIconMaterial}">
                                    <Setter Property="Kind" Value="LockOpenVariant" />
                                    <Setter Property="ToolTip" Value="Image Roll is unlocked." />

                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsLocked}" Value="True">
                                            <Setter Property="Kind" Value="Lock" />
                                            <Setter Property="ToolTip" Value="Image Roll is locked." />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </iconPacks:PackIconMaterial.Style>
                        </iconPacks:PackIconMaterial>

                        <!--  Icon indicating the storage type (database or directory).  -->
                        <iconPacks:PackIconMaterial
                            Margin="3"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center">
                            <iconPacks:PackIconMaterial.Style>
                                <Style TargetType="{x:Type iconPacks:PackIconMaterial}">
                                    <Setter Property="Kind" Value="Database" />
                                    <Setter Property="ToolTip" Value="Images are stored in a database." />

                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RollType}" Value="Directory">
                                            <Setter Property="Kind" Value="Folder" />
                                            <Setter Property="ToolTip" Value="Images are loaded from a directory. Read Only!" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </iconPacks:PackIconMaterial.Style>
                        </iconPacks:PackIconMaterial>

                    </DockPanel>
                </Grid>
            </DockPanel>
        </md:Card>
    </DataTemplate>

</ResourceDictionary>