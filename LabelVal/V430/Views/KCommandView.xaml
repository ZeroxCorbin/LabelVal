<UserControl
    x:Class="LabelVal.V430.Views.KCommandView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:componentmodel="clr-namespace:System.ComponentModel;assembly=WindowsBase"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:hex="clr-namespace:HexView.Wpf;assembly=HexView.Wpf"
    xmlns:json="clr-namespace:JSONViewer_WPF;assembly=JSONViewer_WPF"
    xmlns:local="clr-namespace:LabelVal.V430.Views"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:md="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
    xmlns:omron="clr-namespace:OMRON.Reader.SDK.KCommands.Models;assembly=OMRON.Reader.SDK-0.1"
    xmlns:templates="clr-namespace:LabelVal.V430.Views.TemplateSelectors"
    xmlns:vm="clr-namespace:LabelVal.V430.ViewModels"
    d:DataContext="{d:DesignInstance Type=vm:V430ViewModel,
                                     IsDesignTimeCreatable=False}"
    mc:Ignorable="d">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/V430/Views/KCommandDataTemplates.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <CollectionViewSource
                x:Key="FieldsCollection"
                Filter="DemoItemsFilter"
                IsLiveFilteringRequested="True"
                Source="{Binding Controller.CommandBuilder.Fields}">

                <CollectionViewSource.SortDescriptions>
                    <componentmodel:SortDescription PropertyName="Cmd" />
                    <componentmodel:SortDescription PropertyName="FieldNumber" />
                </CollectionViewSource.SortDescriptions>

                <CollectionViewSource.GroupDescriptions>
                    <PropertyGroupDescription PropertyName="Cat" />
                    <PropertyGroupDescription PropertyName="Cmd" />
                </CollectionViewSource.GroupDescriptions>
            </CollectionViewSource>


            <templates:KCommandTemplateSelector
                x:Key="KCommandTemplateSelector"
                KCommandCharArrayTemplate="{StaticResource KCommandCharArray}"
                KCommandRangeTemplate="{StaticResource KCommandRange}"
                KCommandSelectTemplate="{StaticResource KCommandSelect}"
                KCommandStringTemplate="{StaticResource KCommandString}" />

            <templates:KCommandGrouStyleSelector
                x:Key="KCommandGroupStyleSelector"
                CardGroupStyle="{StaticResource CardGroupStyle}"
                CollectionGroupStyle="{StaticResource CollectionGroupStyle}"
                DefaultGroupStyle="{StaticResource DefaultGroupStyle}" />
        </ResourceDictionary>

    </UserControl.Resources>

    <DockPanel>
        <ScrollViewer MaxHeight="600">

            <ItemsControl
                x:Name="KCommandItems"
                ItemTemplateSelector="{StaticResource KCommandTemplateSelector}"
                ItemsSource="{Binding Source={StaticResource FieldsCollection}}">

                <ItemsControl.GroupStyle>
                    <GroupStyle ContainerStyleSelector="{StaticResource KCommandGroupStyleSelector}" />
                </ItemsControl.GroupStyle>

                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="1" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

            </ItemsControl>
        </ScrollViewer>
    </DockPanel>


</UserControl>
